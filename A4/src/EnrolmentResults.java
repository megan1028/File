import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.NoSuchElementException;
import java.util.Scanner;
//------------------------------------------------------- 
//Assignment 4
//Written by: (Mengyi Yang, 40048192) 
//For COMP 249 Section (U) ¨C Winter 2018
//by one student
//-------------------------------------------------------

public class EnrolmentResults {

	public static void main(String[] args) {
		CourseList list1=new CourseList();
		CourseList list2=new CourseList();
		list1.sethead(null);
		try {
			Scanner sc=new Scanner(new FileInputStream("Syllabus.txt"));
			Course c=new Course();
			while(sc.hasNext()) {
				c.setCourseID(sc.next());
				c.setCourseName(sc.next());
				c.setCredit(sc.nextDouble());
			    sc.next();
			    String s=sc.next();
				if(s.equals("C"))
				{
					c.setPreID("");
					String co=sc.nextLine();
					if(co.equals(""))
						c.setCoID("");
					else
						{co=co.replaceAll("\\s","");
						c.setCoID(co);
						}
				}
				else
				{	c.setPreID(s);
				   sc.next();
				  String co=sc.nextLine();
				if(co.equals(" "))
					c.setCoID("");
				else
				{co=co.replaceAll("\\s","");
				c.setCoID(co);
				}
				}
			//	System.out.println(c);
				if(list1.gethead()==null)
					list1.addToStart(c);
				//System.out.println(list1.gethead().getCourse());}
				else {
				if(!list1.contains(c.getCourseID()))
				list1.addToStart(c); //before!!!!!!!!!!fail because when pass the reference
				//list1.showListContents();
			}
			}
			sc.close();
		} catch (FileNotFoundException e) {
			System.out.println("Sorry, cannot find");
		}
	//	//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      list1.showListContents();
     //open Request.txt
		System.out.print("Please enter the file name: ");
		Scanner sc=new Scanner(System.in);
		String name=sc.next();
		//System.out.println(name);
		ArrayList<String>arr=new ArrayList<String>(1);

		try {
			Scanner sc1=new Scanner(new FileInputStream(name));
			while(sc1.hasNext()) {
				arr.add(sc1.nextLine());
				}
			int n=arr.indexOf("Requested");
			int s=arr.indexOf("Requested");
			int m=arr.indexOf("Finished");
			if(n==arr.size()-1) //if there is a request
			{
			System.out.println("No enrollment courses found.");
			
			}
		  else {
			while(n<arr.size()-1) {
			n++;			
			boolean no_pre=false;
			boolean no_core=false;
			boolean pre=false;
			boolean core_finish=false;
			boolean core_ing=false;
			boolean pre_co=false;
			//System.out.println(arr.get(n));
			
			CourseList.CourseNode x=list1.find(arr.get(n)); //get the reference of the course
		if(x.getCourse().getPreId()!="") { //there is a pre_request
		while(m!=arr.indexOf("Requested")) {//find what has finished
				m++;
			if(arr.get(m).equals(x.getCourse().getPreId())) {//why when inner class is package is not ok???
				pre=true; //pre is finished
			}
			}
		}
			else 
				no_pre=true; 
			
			m=arr.indexOf("Finished");
			String co=x.getCourse().getCoID();//get co_request
			//System.out.println(co+"11");
			if(co.equals(x.getCourse().getPreId()))
				pre_co=true;//when pre and co are same
				if(co!="") {				
					while(s<arr.size()-1) {
						s++;					
						if(arr.get(s).equals(co))
							core_ing=true;  //course is doing this semester					
					}					
						while(m!=arr.indexOf("Requested")) {
							m++;
						if(arr.get(m).equals(co)) //find co is finished or not
							{  //System.out.println(1);
								core_finish=true; //core is finished
							}
										
						}
					m=arr.indexOf("Finished");
					 s=arr.indexOf("Requested");
				}
				else {
					no_core=true; //no co					
				}
				if(pre || no_pre) { //pre_request is finished or no pre_request
					if(no_core) //no c
						System.out.println("Student can enrol in "+arr.get(n)+" course as he/she has completed the pre-requeste "+x.getCourse().getPreId());
					else if(pre_co) //re and c are same	                	
						System.out.println("Student can enroll in "+arr.get(n)+" courses as he/she has completed both the pre_request and co_request "+x.getCourse().getPreId());
						
	                else {
	                	if(core_ing) //c is doing 
	                    	{

	                		System.out.println("Student can enroll in "+arr.get(n)+" courses as he/she has completed both the pre_request "+x.getCourse().getPreId()+"and co_request "+x.getCourse().getCoID()+" is doing this semester");
	                    	}
	                	else if(core_finish)//c is finished
	                    	System.out.println("Student can enroll in "+arr.get(n)+" courses as he/she has completed both the pre_request "+x.getCourse().getPreId()+"and co_request "+x.getCourse().getCoID()+" is also finished");
	                	else//c is not meet request
	                    	System.out.println("Student can't enroll in "+arr.get(n)+" courses as he/she doesn't have sufficient backgroung needed.");
	                  }
				}
				
				else if(no_pre&&no_core)// no request
					System.out.println("Student can enrol in "+arr.get(n)+", since there is no request fot this course.");
				else { //not finished pre
                   if(pre_co) //re and c are same	                	
                   {
                	   if(core_ing) //c is doing 
                   	{
               		System.out.println("Student can enroll in "+arr.get(n)+" courses as he/she is enrolling in co-requisite "+x.getCourse().getCoID()); 
                   	}               
               
                 }else
	            	System.out.println("Student can't enroll in "+arr.get(n)+" courses as he/she doesn't have sufficient backgroung needed.");
				
				}
		}
			}
      sc1.close();
	
		} catch (FileNotFoundException e) {
			System.out.println("Sorry, cannot find");

		}
		System.out.println("\n\nPlease enter the courseID:(end with 'X') ");
		int iteration=0;
		String s=sc.next();
					
		try {
			while(!s.equalsIgnoreCase("x")) {
				iteration++;
		System.out.println(list1.find(s).getCourse());
		System.out.println("iteration: "+iteration);
		 s=sc.next();
		}
		}
		catch(Exception e) {
			System.out.println("You entered an invalid file.");
		}
		
		
		CourseList list3=new CourseList(list1); //copy constructor
		list3.showListContents();
		//list1.showListContents();
		//System.out.println(list3.size());
		list3.setSize(list3.size());
		if(list3.equals(list1))
			System.out.println("List1 and List3 are same.");
		else
			System.out.println("List1 and List3 are different.");
		Course creat=new Course("ACCO230","Account",3,"","");
		try{
			list3.insertAtindex(creat, 3);
		}
		catch( NoSuchElementException e) {
			System.out.println("Error");
		}
		System.out.println("\nAfter insert at index");
		list3.showListContents();
		try {
		list3.deleteFromindex(3);
		}
		catch( NoSuchElementException e) {
			System.out.println("Error");
		}
		System.out.println("\nAfter delete from index");
		list3.showListContents();
		list3.deleteFromStart();
		System.out.println("\nAfter delete from start:");
		list3.showListContents();
		System.out.println("\nAfter replace at index:");
		list3.replaceAtIndex(creat, 3);
		list3.showListContents();
		//list1.showListContents();
		System.out.println("\nHere is the size of list3 from getSize() method:");
		System.out.println(list3.getSize());
		System.out.println("\nHere is the size of list3 from size() method:");
		System.out.println(list3.size());
		System.out.println("Please enter two courses which you want to test whether they are related are no:");
		String first=sc.next();
		String second=sc.next();
		CourseList.CourseNode c1=list1.find(first);
		CourseList.CourseNode c2=list1.find(second);
		//System.out.println(c2.getCourse());
		if((c1.getCourse()).isDirectlyRelated(c2.getCourse()))
			System.out.println("These two course are directly related.");
		else
		System.out.println("They are not directly related.");
		System.out.println("Thank you for using!");
		sc.close();
		}
}
